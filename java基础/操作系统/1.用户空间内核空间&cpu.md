## 用户空间  内核空间
* 普通程序的代码是跑在用户空间上的，而操作系统的代码跑在内核空间上
* 用户空间无法直接访问内核空间的
* 运行在用户空间时就处于用户态，运行在内核空间时就处于内核态
* 调用操作系统内核提供的 API 时，就会进行上下文的切换，切换到内核态中
## cpu
### CPU 缓存一致性
* 把数据同时写入内存和 Cache 中，这种方法称为写直达（Write Through）。
  * 写回（Write Back）当发生写操作时，新的数据仅仅被写入 Cache Block 里，只有当修改过的 Cache Block「被替换」时才需要写到内存中
    * 缓存一致性问题   A 号核心和 B 号核心的缓存，在这个时候是不一致，从而会导致执行结果的错误 

        1.第一点，某个 CPU 核心里的 Cache 数据更新时，必须要传播到其他核心的 Cache，这个称为写传播（Wreite Propagation）；
        
        总线嗅探（Bus Snooping）
        CPU 需要每时每刻监听总线上的一切活动，但是不管别的核心的 Cache 是否缓存相同的数据，都需要发出一个广播事件，这无疑会加重总线的负载。

        MESI 协议 基于总线嗅探机制实现了事务串形化，也用状态机机制降低了总线带宽压力
        Modified，已修改 Exclusive，独占 Shared，共享 Invalidated，已失效

      当 Cache Line 状态是「已修改」或者「独占」状态时，修改更新其数据不需要发送广播给其他 CPU 核心，这在一定程度上减少了总线带宽压力

        2.第二点，某个 CPU 核心里对数据的操作顺序，必须在其他核心看起来顺序是一样的，这个称为事务的串形化（Transaction Serialization）。
+ 